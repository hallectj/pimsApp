!function(b){b.filters={append:function(e){var t=(e=e||{}).label,n=e.name,i=e.type,a=e.value,l=e.operator,o=e.select_options,p=e.index,s="f["+n+"]["+p+"][v]",d="f["+n+"]["+p+"][o]",r=null,c=null;switch(i){case"boolean":r=b('<select class="input-sm form-control"></select>').prop("name",s).append('<option value="_discard">...</option>').append(b('<option value="true"></option>').prop("selected","true"==a).text(RailsAdmin.I18n.t("true"))).append(b('<option value="false"></option>').prop("selected","false"==a).text(RailsAdmin.I18n.t("false"))).append('<option disabled="disabled">---------</option>').append(b('<option value="_present"></option>').prop("selected","_present"==a).text(RailsAdmin.I18n.t("is_present"))).append(b('<option value="_blank"></option>').prop("selected","_blank"==a).text(RailsAdmin.I18n.t("is_blank")));break;case"date":c=b('<input size="20" class="date additional-fieldset default input-sm form-control" type="text" />').css("display",l&&"default"!=l?"none":"inline-block").prop("name",s+"[]").prop("value",a[0]||"").add(b('<input size="20" placeholder="-\u221e" class="date additional-fieldset between input-sm form-control" type="text" />').css("display","between"==l?"inline-block":"none").prop("name",s+"[]").prop("value",a[1]||"")).add(b('<input size="20" placeholder="\u221e" class="date additional-fieldset between input-sm form-control" type="text" />').css("display","between"==l?"inline-block":"none").prop("name",s+"[]").prop("value",a[2]||""));case"datetime":case"timestamp":r=r||b('<select class="switch-additionnal-fieldsets input-sm form-control"></select>').prop("name",d).append(b('<option data-additional-fieldset="default" value="default"></option>').prop("selected","default"==l).text(RailsAdmin.I18n.t("date"))).append(b('<option data-additional-fieldset="between" value="between"></option>').prop("selected","between"==l).text(RailsAdmin.I18n.t("between_and_"))).append(b('<option value="today"></option>').prop("selected","today"==l).text(RailsAdmin.I18n.t("today"))).append(b('<option value="yesterday"></option>').prop("selected","yesterday"==l).text(RailsAdmin.I18n.t("yesterday"))).append(b('<option value="this_week"></option>').prop("selected","this_week"==l).text(RailsAdmin.I18n.t("this_week"))).append(b('<option value="last_week"></option>').prop("selected","last_week"==l).text(RailsAdmin.I18n.t("last_week"))).append('<option disabled="disabled">---------</option>').append(b('<option value="_not_null"></option>').prop("selected","_not_null"==l).text(RailsAdmin.I18n.t("is_present"))).append(b('<option value="_null"></option>').prop("selected","_null"==l).text(RailsAdmin.I18n.t("is_blank"))),c=c||b('<input size="25" class="datetime additional-fieldset default input-sm form-control" type="text" />').css("display",l&&"default"!=l?"none":"inline-block").prop("name",s+"[]").prop("value",a[0]||"").add(b('<input size="25" placeholder="-\u221e" class="datetime additional-fieldset between input-sm form-control" type="text" />').css("display","between"==l?"inline-block":"none").prop("name",s+"[]").prop("value",a[1]||"")).add(b('<input size="25" placeholder="\u221e" class="datetime additional-fieldset between input-sm form-control" type="text" />').css("display","between"==l?"inline-block":"none").prop("name",s+"[]").prop("value",a[2]||""));break;case"enum":var u=a instanceof Array;r=b('<select class="select-single input-sm form-control"></select>').css("display",u?"none":"inline-block").prop("name",u?undefined:s).data("name",s).append('<option value="_discard">...</option>').append(b('<option value="_present"></option>').prop("selected","_present"==a).text(RailsAdmin.I18n.t("is_present"))).append(b('<option value="_blank"></option>').prop("selected","_blank"==a).text(RailsAdmin.I18n.t("is_blank"))).append('<option disabled="disabled">---------</option>').append(o).add(b('<select multiple="multiple" class="select-multiple input-sm form-control"></select>').css("display",u?"inline-block":"none").prop("name",u?s+"[]":undefined).data("name",s+"[]").append(o)).add(b('<a href="#" class="switch-select"></a>').append(b("<i></i>").addClass("icon-"+(u?"minus":"plus"))));break;case"string":case"text":case"belongs_to_association":r=b('<select class="switch-additionnal-fieldsets input-sm form-control"></select>').prop("value",l).prop("name",d).append('<option value="_discard">...</option>').append(b('<option data-additional-fieldset="additional-fieldset" value="like"></option>').prop("selected","like"==l).text(RailsAdmin.I18n.t("contains"))).append(b('<option data-additional-fieldset="additional-fieldset" value="is"></option>').prop("selected","is"==l).text(RailsAdmin.I18n.t("is_exactly"))).append(b('<option data-additional-fieldset="additional-fieldset" value="starts_with"></option>').prop("selected","starts_with"==l).text(RailsAdmin.I18n.t("starts_with"))).append(b('<option data-additional-fieldset="additional-fieldset" value="ends_with"></option>').prop("selected","ends_with"==l).text(RailsAdmin.I18n.t("ends_with"))).append('<option disabled="disabled">---------</option>').append(b('<option value="_present"></option>').prop("selected","_present"==l).text(RailsAdmin.I18n.t("is_present"))).append(b('<option value="_blank"></option>').prop("selected","_blank"==l).text(RailsAdmin.I18n.t("is_blank"))),c=b('<input class="additional-fieldset input-sm form-control" type="text" />').css("display","_present"==l||"_blank"==l?"none":"inline-block").prop("name",s).prop("value",a);break;case"integer":case"decimal":case"float":r=b('<select class="switch-additionnal-fieldsets input-sm form-control"></select>').prop("name",d).append(b('<option data-additional-fieldset="default" value="default"></option>').prop("selected","default"==l).text(RailsAdmin.I18n.t("number"))).append(b('<option data-additional-fieldset="between" value="between"></option>').prop("selected","between"==l).text(RailsAdmin.I18n.t("between_and_"))).append('<option disabled="disabled">---------</option>').append(b('<option value="_not_null"></option>').prop("selected","_not_null"==l).text(RailsAdmin.I18n.t("is_present"))).append(b('<option value="_null"></option>').prop("selected","_null"==l).text(RailsAdmin.I18n.t("is_blank"))),c=b('<input class="additional-fieldset default input-sm form-control" type="text" />').css("display",l&&"default"!=l?"none":"inline-block").prop("type",i).prop("name",s+"[]").prop("value",a[0]||"").add(b('<input placeholder="-\u221e" class="additional-fieldset between input-sm form-control" />').css("display","between"==l?"inline-block":"none").prop("type",i).prop("name",s+"[]").prop("value",a[1]||"")).add(b('<input placeholder="\u221e" class="additional-fieldset between input-sm form-control" />').css("display","between"==l?"inline-block":"none").prop("type",i).prop("name",s+"[]").prop("value",a[2]||""));break;default:r=b('<input type="text" class="input-sm form-control" />').prop("name",s).prop("value",a)}var m=n+"-"+p+"-filter-container";b("p#"+m).remove();var f=b("<p>").attr("id",m).addClass("filter form-search").append(b('<span class="label label-info form-label"></span>').append(b('<a href="#delete" class="delete"></a>').append('<i class="fa fa-trash-o fa-fw icon-white"></i>').append(document.createTextNode(t)))).append("&nbsp;").append(r).append("&nbsp;").append(c);b("#filters_box").append(f),f.find(".date, .datetime").datetimepicker({locale:RailsAdmin.I18n.locale,showTodayButton:!0,format:e.datetimepicker_format}),b("hr.filters_box:hidden").show("slow")}},b(document).on("click","#filters a",function(e){e.preventDefault(),b.filters.append({label:b(this).data("field-label"),name:b(this).data("field-name"),type:b(this).data("field-type"),value:b(this).data("field-value"),operator:b(this).data("field-operator"),select_options:b(this).data("field-options"),index:b.now().toString().slice(6,11),datetimepicker_format:b(this).data("field-datetimepicker-format")})}),b(document).on("click","#filters_box .delete",function(e){e.preventDefault(),form=b(this).parents("form"),b(this).parents(".filter").remove(),!b("#filters_box").children().length&&b("hr.filters_box:visible").hide("slow")}),b(document).on("click","#filters_box .switch-select",function(e){e.preventDefault();var t=b(this).siblings("select:visible"),n=b(this).siblings("select:hidden");n.attr("name",n.data("name")).show("slow"),t.attr("name",null).hide("slow"),b(this).find("i").toggleClass("icon-plus icon-minus")}),b(document).on("change","#filters_box .switch-additionnal-fieldsets",function(){var e=b(this).find("option:selected");(klass=b(e).data("additional-fieldset"))?(b(this).siblings(".additional-fieldset:not(."+klass+")").hide("slow"),b(this).siblings("."+klass).show("slow")):b(this).siblings(".additional-fieldset").hide("slow")})}(jQuery);